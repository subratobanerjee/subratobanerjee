resources:
  jobs:
    snowflake_uniform_refresh:
      name: snowflake_uniform_refresh
      max_concurrent_runs: 1
      
      webhook_notifications:
        on_failure:
          - id: ${var.slack_webhook}

      schedule:
        quartz_cron_expression: 0 0/5 * * * ? *
        timezone_id: UTC
        pause_status: UNPAUSED

      # environments:
      #   - environment_key: utils_env
      #     spec:
      #       client: "1"
      #       dependencies:
      #         - /Workspace/Users/${workspace.current_user.userName}/${bundle.name}/${bundle.target}/artifacts/.internal/${var.wheel_name}-0.1-py3-none-any.whl
      
      tasks:
        - task_key: snowflake_iceberg_refresh
          # environment_key: utils_env
          notebook_task:
            notebook_path: ../src/snowflake/snowflake_iceberg_refresh.py
            base_parameters:
              inputParam: '{"environment":"${var.environment}"}'

      tags:
        business_unit: "utils"

      permissions:
        - level: CAN_MANAGE
          group_name: "data engineering"