# Date configuration - supports both single date and date range
date_config:
  mode: "range"  # Options: "today", "single", "range"
  from_date: "2025-06-19"  # Used when mode is "single" or "range"
  to_date: "2025-06-25"    # Used when mode is "range"
  date_column: "dw_insert_ts"  # Column to apply date filter on

datasets:
  - name: nero{env}.intermediate.fact_player_activity
    attributes:
      business_unit: ["Core Games"]
      data_layer: ["intermediate"]
      data_owner: ["Data Engineering"]
      title_name: ["nero"]
      pii: false
      priority: ["P1"]
    checks:
      - name: row_count
      - name: null_check
        columns: [player_id, parent_id, session_id, platform, service, country_code, received_on, source_table, desc, event_trigger]
      - name: duplicate
        columns:
          - [player_id, parent_id, session_id, platform, service, country_code, received_on, source_table, desc, event_trigger, build_changelist, language_setting, extra_info_1, extra_info_2, extra_info_3, extra_info_4, extra_info_5, extra_info_6, extra_info_7, extra_info_8, extra_info_9, extra_info_10]

threshold_percent: 0 # expected (ideal) value for the check, 0% nulls or 0 duplicates.
warn_percentage: 0.0 # upper boundary beyond which Soda will raise a warning, nulls or duplicates exceed 0%, Soda will warn, but not fail.
fail_percentage: 0.0 # threshold that, when crossed, causes the check to fail, nulls or duplicates exceed 0%, the check is marked as failed.

# 0% nulls/dups → pass, 6% nulls/dups → warning, 16% nulls/dups → fail
